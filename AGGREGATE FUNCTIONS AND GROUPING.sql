-- CREATE COMPANY DATABASE 
CREATE DATABASE IF NOT EXISTS COMPANY_DB;

-- SWITCH DATABASE
USE COMPANY_DB;

-- CREATE EMPLOYEES TABLE
CREATE TABLE EMPLOYEES(
EMP_ID INT PRIMARY KEY,
EMP_NAME VARCHAR(255) NOT NULL,
DEPARTMENT VARCHAR(255) NOT NULL,
SALARY DECIMAL(10,2) NOT NULL,
LOCATION VARCHAR(255) NOT NULL,
HIRE_DATE DATE NOT NULL);

-- INSERT INTO EMPLOYEE DETAILS
INSERT INTO EMPLOYEES(EMP_ID,EMP_NAME,DEPARTMENT,SALARY,LOCATION,HIRE_DATE)VALUES
(1,'SRAVANI BODAPATI','HR',50000,'HYD','2024-5-6'),
(2,'NIRAJA KAMANA','MARKETING',30000,'AP','2023-2-2'),
(3,'MANISHA SHAK','AUDIT',40000,'MUMBAI','2025-1-19'),
(4,'LAVANYA PONDARU','FINANCE',25000,'MUMBAI','2022-4-29'),
(5,'MANOJ PITANI','IT',20000,'KERALA','2020-10-7'),
(6,'GANESH ANUKULA','AUDIT',15000,'HYD','2022-12-26');

-- RETRIVE DATA
SELECT*FROM EMPLOYEES;

/*
EMP_ID  EMP_NAME          DEPARTMENET  SALARY    LOCATION  HIRE_DATE
1	    SRAVANI BODAPATI  HR	       50000.00	 HYD	   2024-05-06
2	    NIRAJA KAMANA	  MARKETING	   30000.00	 AP	       2023-02-02
3	    MANISHA SHAK	  AUDIT	       40000.00	 MUMBAI	   2025-01-19
4	    LAVANYA PONDARU	  FINANCE	   25000.00	 MUMBAI	   2022-04-29
5	    MANOJ PITANI	  IT	       20000.00	 KERALA	   2020-10-07
6	    GANESH ANUKULA	  AUDIT	       15000.00	 HYD	   2022-12-26
*/

-- COMMON AGGREGATE FUNCTIONS

-- TOTAL SALARY IN A TABLE
SELECT SUM(SALARY) AS TOTAL FROM EMPLOYEES;

/*
TOTAL
-----
180000.00
*/

-- AVERAGE SALARY PER LOCATION
SELECT AVG(SALARY) AS AVERAGE FROM EMPLOYEES;
/*
AVERAGE
-----
30000.000000
*/
 -- COUNT NO OF ROWS
 SELECT COUNT(*) AS COUNT FROM EMPLOYEES;
/*
COUNT
-----
6
*/

-- MAXIMUM SALARY
SELECT MAX(SALARY) AS MAX FROM EMPLOYEES;
/*
MAX
-----
50000.000000
*/

-- MINIMUM SALARY
SELECT MIN(SALARY)AS MIN FROM EMPLOYEES;
/*
MIN
-----
15000.000000
*/
    -- GROUP BY FUNCTION
-- TOTAL SALARY PER DEPARTMENT
SELECT SUM(SALARY) AS TOTAL FROM EMPLOYEES GROUP BY DEPARTMENT;
/*
TOTAL
--------
50000.00
30000.00
55000.00
25000.00
20000.00
*/

-- AVERAGE SALARY PER LOCATION
SELECT AVG(SALARY) AS AVG FROM EMPLOYEES GROUP BY LOCATION;
/*
AVG
32500.000000
30000.000000
32500.000000
20000.000000
*/

-- HIGHEST SALARY IN EACH DEPARTMENT
SELECT MAX(SALARY) AS MAXIMUM FROM EMPLOYEES GROUP BY DEPARTMENT;

/*
MAXIMUM
50000.00
30000.00
40000.00
25000.00
20000.00
*/

-- NUMBER OF EMPLOYEES PER DEPARTMENT
SELECT COUNT(*)AS COUNT FROM EMPLOYEES GROUP BY DEPARTMENT;

/*
COUNT
-----
1
1
2
1
1
*/
-- HAVING FUNCTION

-- DEPARTMENT WITH TOTAL SALARY ABOVE 500000
SELECT SUM(SALARY) AS TOTAL FROM EMPLOYEES GROUP BY DEPARTMENT HAVING SUM(SALARY)>50000;
/*
TOTAL
-----
55000.00
*/